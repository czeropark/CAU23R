---
title: "W07 Assignment #2 Solution"
author: Seayoung Park
output: html_notebook
---


##  Assignment \#2 <font color= "red">Due: Oct.17(Tue) 23:59 </font>

Using `dplyr` and `sizekorea_8th.csv`, create 3 data frames that show\:

1. Proportion of `age range` 나이대 비율
1. Average `waist` by `gender` by `age range`. 성별 나이대별 평균 허리둘레
1. Proportion of 3 weight groups based on `bmi` in each `region` (3 weight groups as in this code file) 지역별로 각 체중그룹이 차지하는 비율 (이 코드에서와 같은 3개 체중그룹 이용)


---

---

Load package and read csv data. (from url this time.)
```{r}
library(dplyr)

size_raw <- read.csv("https://raw.githubusercontent.com/czeropark/CAU23R/main/sizekorea_8th.csv") 
head(size_raw)
str(size_raw)
```


Rename columns to use.
```{r}
size_renamed<- size_raw %>% rename(ID= HUMAN_ID ,
                             height = X002..height,
                             waist = X045..waist_circumference,
                             weight = X125..weight) # use tab key :)
head(size_renamed)
```


Select columns to use.
```{r}
size<- size_renamed%>% select(ID, gender, age, region, height, waist, weight)
head(size)
```

---

### &#129002; 1. Proportion of `age range` 나이대 비율


```{r}
size_ageRange <- size %>% mutate(ageRange = age%/%10) # calculate ageRange
size_ageRange_ratio <- size_ageRange %>% 
  group_by(ageRange) %>% # grouping criteria : ageRange
  summarise(ageRange_sum = sum(n())) %>%  # total number of people(rows) in each ageRange group?
  mutate(ageRange_ratio = ageRange_sum/sum(ageRange_sum)) # total number of people in each ageRange / total number of people without any grouping
size_ageRange_ratio
```

--- 


### &#129002; 2. Average `waist` by `gender` by `age range`. 성별 나이대별 평균 허리둘레

```{r}
size_waist_ageRange_gender <- size_ageRange %>% 
  group_by(gender, ageRange) %>% #by gender by ageRange
  summarise(avgWaist=mean(waist)) # mean waist. "one line" for "one group" of gender*ageRange  -> summarise. If you use mutate, all rows will be printed, not being grouped.
size_waist_ageRange_gender
```

---

### &#129002; 3. Proportion of 3 weight groups based on `bmi` in each `region` (3 weight groups as in this code file) 지역별로 각 체중그룹이 차지하는 비율 (이 코드에서와 같은 3개 체중그룹 이용)


```{r}
size_obese3 <- size %>%
  mutate(bmi = weight/(height/1000)^2) %>%
  mutate(obese = if_else(bmi>=25, "overweight",
                         if_else(bmi<18.5, "underweight",
                                 "healthy")))

size_obese3 %>% 
  group_by(region, obese) %>% #grouping by region by obese
  summarise(numberOfPeople = n()) %>% #total number of people(rows) in each region * obese group (9 groups) after this operation, group will be reduced into 3, only by region.
  mutate(ratioInEachRegion = numberOfPeople/sum(numberOfPeople)) # calculate ratio. now, sum wil sum up the rows with the same regions, not region*obese, because of summarise a step before.

```

---